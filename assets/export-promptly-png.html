<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Export Promptly Logos as PNG</title>
    <style>
      body{font-family:Inter, system-ui, -apple-system, BlinkMacSystemFont,Segoe UI, Roboto, Arial; padding:24px; background:#0b0b0d; color:#f5f6f8}
      main{max-width:880px;margin:0 auto}
      h1{margin:0 0 12px}
      .card{background:rgba(255,255,255,0.03);padding:16px;border-radius:12px;margin:12px 0}
      label{display:inline-block;margin-right:8px}
      input[type=number]{width:90px;padding:6px;border-radius:6px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:inherit}
      button{margin-left:8px;padding:8px 12px;border-radius:8px;border:none;background:linear-gradient(135deg,#7f5af0,#2cb1bc);color:#06060a;font-weight:700}
      .note{color:rgba(245,246,248,0.64);font-size:0.92rem}
      .preview{display:block;margin-top:12px;border-radius:8px;background:#fff;max-width:100%}
    </style>
  </head>
  <body>
    <main>
      <h1>Export Promptly logo as PNG</h1>
      <p class="note">Open this page through a local server (e.g., <code>python3 -m http.server</code>) and click the buttons to download PNGs rendered from the SVG assets in <code>assets/</code>.</p>

      <div class="card">
        <h2>Wordmark</h2>
        <p class="note">Renders <code>assets/promptly-logo.svg</code> to PNG.</p>
        <div>
          <label for="wm-w">Width:</label>
          <input id="wm-w" type="number" value="1024" min="64" />
          <label for="wm-h">Height:</label>
          <input id="wm-h" type="number" value="176" min="64" />
          <button id="download-wm">Download Wordmark PNG</button>
        </div>
        <canvas id="canvas-wm" class="preview" width="1024" height="176" style="display:none"></canvas>
      </div>

      <div class="card">
        <h2>Icon (square)</h2>
        <p class="note">Renders <code>assets/promptly-icon.svg</code> to PNG.</p>
        <div>
          <label for="ic-size">Size:</label>
          <input id="ic-size" type="number" value="512" min="64" />
          <button id="download-ic">Download Icon PNG</button>
        </div>
        <canvas id="canvas-ic" class="preview" width="512" height="512" style="display:none"></canvas>
      </div>

      <p class="note">If downloads don't start, open the browser console for errors (CORS or file access). Use a local server rather than opening this file via file://.</p>
    </main>

    <script>
      async function fetchText(path){
        const res = await fetch(path);
        if(!res.ok) throw new Error('Failed to fetch '+path+' - status '+res.status);
        return await res.text();
      }

      function svgToDataUrl(svgText){
        return 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent(svgText);
      }

      function renderSvgToCanvas(svgText, width, height, canvas){
        return new Promise((resolve, reject) => {
          const img = new Image();
          img.onload = () => {
            canvas.width = width;
            canvas.height = height;
            const ctx = canvas.getContext('2d');
            // clear with transparent
            ctx.clearRect(0,0,canvas.width, canvas.height);
            // Draw white background optionally. Keep transparent by default.
            ctx.drawImage(img, 0, 0, width, height);
            resolve(canvas);
          };
          img.onerror = (e) => reject(e);
          img.src = svgToDataUrl(svgText);
        });
      }

      function downloadCanvasAsPng(canvas, filename){
        const url = canvas.toDataURL('image/png');
        const a = document.createElement('a');
        a.href = url;
        a.download = filename;
        document.body.appendChild(a);
        a.click();
        a.remove();
      }

      document.getElementById('download-wm').addEventListener('click', async ()=>{
        try{
          const w = parseInt(document.getElementById('wm-w').value,10) || 1024;
          const h = parseInt(document.getElementById('wm-h').value,10) || Math.round(w*0.172);
          const svg = await fetchText('promptly-logo.svg');
          const canvas = document.getElementById('canvas-wm');
          await renderSvgToCanvas(svg, w, h, canvas);
          downloadCanvasAsPng(canvas, `promptly-wordmark-${w}x${h}.png`);
        }catch(err){
          console.error(err);
          alert('Error exporting wordmark. See console.');
        }
      });

      document.getElementById('download-ic').addEventListener('click', async ()=>{
        try{
          const s = parseInt(document.getElementById('ic-size').value,10) || 512;
          const svg = await fetchText('promptly-icon.svg');
          const canvas = document.getElementById('canvas-ic');
          await renderSvgToCanvas(svg, s, s, canvas);
          downloadCanvasAsPng(canvas, `promptly-icon-${s}x${s}.png`);
        }catch(err){
          console.error(err);
          alert('Error exporting icon. See console.');
        }
      });
    </script>
  </body>
</html>
